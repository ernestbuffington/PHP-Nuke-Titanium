##########################################################################
# PHP-Nuke Titanium v1.0.1z                                              #
##########################################################################

# ---------------------------------------------------------------
# The Network does not allow register globals to be on!
# ---------------------------------------------------------------
# PHP_FLAG register_globals On 
# PHP_FLAG output_buffering On
# ---------------------------------------------------------------

Options All -Indexes

# ---------------------------------------------------------------
# Swap index.html index.php for html start page!
# ---------------------------------------------------------------
DirectoryIndex index.php index.html

Options +FollowSymlinks

<IfModule mod_rewrite.c> 
RewriteEngine on

# ---------------------------------------------------------------
# Force SSL - no insecure data connections!
# ---------------------------------------------------------------
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# ---------------------------------------------------------------
# Security Rewrites
# ---------------------------------------------------------------
RewriteCond %{THE_REQUEST} (\?act\=) [NC,OR]
RewriteCond %{THE_REQUEST} (sql_login) [NC,OR]
RewriteCond %{THE_REQUEST} (basepath) [OR]
RewriteCond %{THE_REQUEST} (libpath) [OR]
RewriteCond %{THE_REQUEST} (absolute_path) [OR]
RewriteCond %{THE_REQUEST} (vwar_root) [OR]
RewriteCond %{THE_REQUEST} (includedir) [OR]
RewriteCond %{THE_REQUEST} (file=http:\/\/) [OR]
RewriteCond %{THE_REQUEST} (name=http:\/\/) [OR]
RewriteCond %{THE_REQUEST} (phpbb_root_path)
RewriteRule ^.*$ http://127.0.0.1/ [R=301,L]

# -------------------------------------------------------------------------------------------------------------------------------------------------
# Lazy Google Tap
# -------------------------------------------------------------------------------------------------------------------------------------------------
RewriteRule ^The-86it-Network-(.*)_-_(.*)_-_(.*)_-_(.*)_-_(.*)_-_(.*)_-_(.*)_-_(.*)_-_(.*)\.html$ /modules.php?name=$1&$2=$3&$4=$5&$6=$7&$8=$9 [L]
RewriteRule ^The-86it-Network-(.*)_-_(.*)_-_(.*)_-_(.*)_-_(.*)_-_(.*)_-_(.*)\.html#(.*)$ /modules.php?name=$1&$2=$3&$4=$5&$6=$7#$8 [L]
RewriteRule ^The-86it-Network-(.*)_-_(.*)_-_(.*)_-_(.*)_-_(.*)_-_(.*)_-_(.*)\.html$ /modules.php?name=$1&$2=$3&$4=$5&$6=$7 [L]
RewriteRule ^The-86it-Network-(.*)_-_(.*)_-_(.*)_-_(.*)_-_(.*)\.html#(.*)$ /modules.php?name=$1&$2=$3&$4=$5#$6 [L]
RewriteRule ^The-86it-Network-(.*)_-_(.*)_-_(.*)_-_(.*)_-_(.*)\.html$ /modules.php?name=$1&$2=$3&$4=$5 [L]
RewriteRule ^The-86it-Network-(.*)_-_(.*)_-_(.*)\.html#(.*)$ /modules.php?name=$1&$2=$3#$4 [L]
RewriteRule ^The-86it-Network-(.*)_-_(.*)_-_(.*)\.html$ /modules.php?name=$1&$2=$3 [L]
RewriteRule ^The-86it-Network-index.html#(.*)$ /index.php#$1 [L]
RewriteRule ^The-86it-Network-index.html$ /index.php [L]
RewriteRule ^The-86it-Network-(.*)\.html#(.*)$ /modules.php?name=$1#$2 [L]
RewriteRule ^The-86it-Network-(.*)\.html$ /modules.php?name=$1 [L]

RewriteCond %{HTTP_USER_AGENT} ^libwww-perl
RewriteRule ^.*$ http://127.0.0.1 [R,L]

RewriteCond %{HTTP_USER_AGENT} ^libwww-perl/[0-9].[0-9]*
RewriteRule ^.*$ http://127.0.0.1 [R,L]

</IfModule>

# --------------------------------------------------------------------------------
# for hosts that don't allow the above, we won't give people anything to look at!
# --------------------------------------------------------------------------------
<IfModule mod_autoindex.c>
 IndexIgnore *
</IfModule>

# ---------------------------------------------------------------
# Start of Error Management
# ---------------------------------------------------------------
ErrorDocument 400 /error.php?error=400
ErrorDocument 401 /error.php?error=401
ErrorDocument 402 /error.php?error=402
ErrorDocument 403 /error.php?error=403
ErrorDocument 404 /error.php?error=404
ErrorDocument 405 /error.php?error=405
ErrorDocument 406 /error.php?error=406
ErrorDocument 407 /error.php?error=407
ErrorDocument 408 /error.php?error=408
ErrorDocument 409 /error.php?error=409
ErrorDocument 410 /error.php?error=410
ErrorDocument 411 /error.php?error=411
ErrorDocument 412 /error.php?error=412
ErrorDocument 413 /error.php?error=413
ErrorDocument 414 /error.php?error=414
ErrorDocument 415 /error.php?error=415
ErrorDocument 500 /error.php?error=500
ErrorDocument 502 /error.php?error=502
ErrorDocument 503 /error.php?error=503
ErrorDocument 504 /error.php?error=504
ErrorDocument 505 /error.php?error=505

# ---------------------------------------------------------------
# Start of NukeSentinel(tm) admin.php Auth
# ---------------------------------------------------------------
<Files .htaccess>
  deny from all
</Files>

<Files .staccess>
  deny from all
</Files>

# <Files admin.php>
#    <Limit GET POST PUT>
#      require valid-user
#    </Limit>
#    AuthName "Restricted"
#    AuthType Basic
#    AuthUserFile /PATH/TO/YOUR/.staccess
# </Files>

# ---------------------------------------------------------------
# Disable .htaccess viewing from browser!
# ---------------------------------------------------------------
<files ~ "^\.ht">
    Order allow,deny
    Deny from all
    Satisfy All
</files>

# ---------------------------------------------------------------
# Disable config.php viewing from browser!
# ---------------------------------------------------------------
<files ~ "\config.php$">
    deny from all
</files>

# ---------------------------------------------------------------
# deny most common except .php/.html !
# ---------------------------------------------------------------
<FilesMatch "\.(inc|tpl|h|ihtml|sql|ini|tsn|conf|class|bin|spd|theme|module|exe)$">
deny from all
</FilesMatch>

# ---------------------------------------------------------------
# Setup caching
# ---------------------------------------------------------------
<IfModule mod_expires.c> 
ExpiresActive On
ExpiresDefault A0

# ---------------------------------------------------------------
# Set up caching on media files for 1 year (forever?)
# ---------------------------------------------------------------
<FilesMatch "\.(ico|flv|pdf|mov|mp3|wmv|ppt)$">
  ExpiresDefault A29030400
  Header append Cache-Control "public"
</FilesMatch>

# ---------------------------------------------------------------
# Set up caching on media files for 1 week!
# ---------------------------------------------------------------
<FilesMatch "\.(gif|jpg|jpeg|png|swf|bmp)$">
ExpiresDefault A604800
Header append Cache-Control "public"
</FilesMatch>

# ---------------------------------------------------------------
# Set up 2 Hour caching on commonly updated files!
# ---------------------------------------------------------------
<FilesMatch "\.(xml|txt|html|js|css)$">
  ExpiresDefault A7200
  Header append Cache-Control "private, proxy-revalidate, must-revalidate"
</FilesMatch>
</IfModule>

# ---------------------------------------------------------------
# Start of NukeSentinel(tm) DENY FROM area
# ---------------------------------------------------------------

# Banned Bad Bots